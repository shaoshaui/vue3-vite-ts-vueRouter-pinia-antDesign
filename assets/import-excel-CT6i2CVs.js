import{P as e}from"./PageWrapper-kP41PToY.js";import{d as t,l as r,t as s,c as o,ap as a,k as i,a as l,ar as n,s as p}from"./index-wpHdHR2i.js";import{u as m}from"./useExcel-qd2Y1JS7.js";import{C as d}from"./index-xeVG-uq4.js";import{U as u}from"./index-H0Ymczcp.js";import{C as c}from"./CloudUploadOutlined-rYm8aADg.js";import{T as x}from"./index-vCwnz0jh.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-bqd2VPDU.js";import"./partition-n7reoxu8.js";import"./DeleteOutlined-iF9bqYom.js";import"./CheckOutlined-CnO-orzS.js";import"./index-WcKB_zJk.js";import"./List-IAZusSc1.js";import"./index-GNzGZrpr.js";import"./index-SRRrCjn5.js";import"./index-jYf-ptjJ.js";import"./Checkbox-on_OXX4p.js";import"./index-xP8h3XvG.js";import"./Group-DpDlOgoh.js";import"./index-DRJJoETW.js";const j=t({name:"ImportExcel",setup(){const t=r([]),j=r([]),{readDataFromExcel:f}=m(),{getThemeColor:g}=s();function C(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void p.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:o}=f(r,"array");j.value=s.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=o},r.readAsArrayBuffer(e),r.onerror=()=>{p.error("Excel文件读取出错!")}}(s):p.warning("上传的Excel文件大小不能超过1M!")}return()=>o(e,{plugin:n},{default:()=>[o(d,null,{default:()=>[o(a,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[o(u,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:C},{default:()=>[o("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[o(c,null,null)]),o("p",null,[i("将Excel文件拖到此处, 或"),o("span",{style:{color:l(g)}},[i("点击上传")])])]}),o(x,{dataSource:l(t),columns:l(j),pagination:!1},null)]})]})]})}});export{j as default};
