var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,n)=>{for(var o in n||(n={}))a.call(n,o)&&i(e,o,n[o]);if(t)for(var o of t(n))l.call(n,o)&&i(e,o,n[o]);return e};import{D as o,R as r,a as s}from"./RichTextSetting-7INot2Ii.js";import{P as u}from"./PageWrapper-kP41PToY.js";import{eP as d,eN as g,d as p,r as h,l as v,e as f,c as m,a as c,Z as y,F as x,B as w,s as b,k as j,eQ as C}from"./index-wpHdHR2i.js";import{U as S}from"./UploadImage-I3C1Dv6A.js";import{g as k,a as I}from"./image-UzVMQwv3.js";import{C as O}from"./index-xeVG-uq4.js";import{R as z,C as P}from"./index-8Uaui4PZ.js";import"./vue-drag-resize-7wbCkvS1.js";import"./index-WcKB_zJk.js";import"./List-IAZusSc1.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-bqd2VPDU.js";import"./CheckOutlined-CnO-orzS.js";import"./index-H0Ymczcp.js";import"./partition-n7reoxu8.js";import"./DeleteOutlined-iF9bqYom.js";const M={x:300,y:100,z:1,w:180,h:36,type:"text",tag:"text_1",active:!1,text:"请输入文本",style:{fontFamily:"微软雅黑",fontSize:"24px",lineHeight:"24px",color:"#687684",backgroundColor:"#9ac8d8",fontWeight:"",fontStyle:"",textShadow:"",textAlign:"left"}},U={x:320,y:260,z:2,w:160,h:160,type:"image",tag:"image_2",active:!1,url:d},A={width:850,height:480,videoUrl:g},E=p({name:"VideoWatermark",setup(){var e;const t=h(A),a=v([M,U]),l=v((null==(e=a.value[0])?void 0:e.tag)||""),i=v(a.value.length),d=f((()=>({position:"relative",width:t.width+"px",height:t.height+"px"}))),g=f((()=>a.value.find((e=>e.tag===l.value)))),p=f((()=>{var e;return"text"===(null==(e=g.value)?void 0:e.type)?g.value:null})),E=()=>{const e=++i.value,t={x:300,y:100,z:a.value.length,w:180,h:36,type:"text",tag:`text_${e}`,active:!1,text:"请输入文本",style:{fontFamily:"微软雅黑",fontSize:"24px",lineHeight:"24px",color:"#687684",backgroundColor:"#9ac8d8",fontWeight:"",fontStyle:"",textShadow:"",textAlign:"left"}};a.value.length>4?b.warning("图片上最多叠加5个元素!"):(a.value.push(t),l.value=t.tag)},F=()=>{if(!c(l))return void b.warning("请先选择元素!");const e=a.value.findIndex((e=>e.tag===c(l)));a.value.splice(e,1),l.value=""},R=e=>{k(e).then((({width:n,height:o})=>{const{width:r,height:s}=I(n,o,Math.floor(t.width/4),Math.floor(t.height/4));(e=>{const t=++i.value,n={x:320,y:300,z:a.value.length,w:e.width,h:e.height,type:"image",tag:`image_${t}`,active:!1,url:e.url};a.value.length>4?b.warning("图片上最多叠加5个元素!"):(a.value.push(n),l.value=M.tag)})({url:e,width:r,height:s})}))};return()=>m(u,{plugin:C},{default:()=>[m(z,{gutter:12},{default:()=>[m(P,{span:16},{default:()=>[m(O,{title:"合成区域",bodyStyle:{height:"550px"}},{default:()=>[m("div",{class:"flex-center"},[m("div",{class:"dnd-container",style:n({},c(d))},[m("video",{src:t.videoUrl,controls:!0,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}},null),a.value.map(((e,t)=>{return m(o,{key:e.tag,element:e,handlers:(i=e.type,"text"===i?["e","w"]:["n","e","s","w","ne","nw","se","sw"]),onChange:e=>((e,t)=>{a.value[t]=e,e.active&&(l.value=e.tag,a.value.forEach((t=>{t.tag!==e.tag&&(t.active=!1)})))})(e,t)},{default:()=>["text"===e.type?m(r,{value:e.text,"onUpdate:value":t=>e.text=t,style:e.style},null):"image"===e.type?m("img",{src:e.url,draggable:"false"},null):m(y,null,null)]});var i}))])])]})]}),m(P,{span:8},{default:()=>[m(O,{title:"设置区域",bodyStyle:{height:"550px"}},{default:()=>{var e,t;return[m(x,{colon:!1,labelCol:{span:6},wrapperCol:{span:18},labelAlign:"left",style:{width:"300px",margin:"0 auto"}},{default:()=>[m(x.Item,{label:"选择视频"},{default:()=>[m(w,{type:"primary",style:{width:"100%"},onClick:()=>b.warning("请配置视频资源服务接口！")},{default:()=>[j("选择视频")]})]}),m(x.Item,{label:"添加文本"},{default:()=>[m(w,{block:!0,style:{width:"100%"},onClick:E},{default:()=>[j("添加文本")]})]}),m(x.Item,{label:"添加图片"},{default:()=>[m(S,{name:"添加图片",isFull:!0,onSuccess:R},null)]}),m(x.Item,{label:"删除元素"},{default:()=>[m(w,{type:"primary",danger:!0,style:{width:"100%"},onClick:F},{default:()=>[j("删除元素")]})]})]}),c(p)?m(s,{textValue:null==(e=c(p))?void 0:e.text,textStyles:null==(t=c(p))?void 0:t.style,onChangeValue:e=>(e=>{a.value.forEach((t=>{t.tag===c(l)&&(t.text=e)}))})(e),onChangeStyles:e=>(e=>{a.value.forEach((t=>{t.tag===c(l)&&(t.style=e)}))})(e)},null):m(y,null,null)]}})]})]})]})}});export{E as default};
