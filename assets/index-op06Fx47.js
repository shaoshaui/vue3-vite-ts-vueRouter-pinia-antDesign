import{P as e}from"./PageWrapper-kjRDiOIM.js";import{d as a,r as t,l,c as i,ap as n,F as o,ao as s,I as u,B as d,k as r,a as p,ar as m,s as c}from"./index-uhPhvMRI.js";import{u as f}from"./useExcel-PiP1NfJQ.js";import{t as x}from"./data-7P7vqW5N.js";import{C as v}from"./index-M8qE7_hJ.js";import{R as h}from"./Group-H5ZmEGII.js";import{S as j}from"./index-gf3IiVSo.js";import{T as y}from"./index-GGph-H7w.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-WtJRF0n5.js";import"./Checkbox-og2vZ6-c.js";import"./List-LLGO4AKa.js";import"./CheckOutlined-YW71hL-F.js";import"./index-8La93q0M.js";import"./index-yGiZe0r7.js";import"./index-OdAF1vjU.js";import"./index-Z3GkruCN.js";import"./index-RKdaFY1h.js";const b=a({name:"ExportExcel",setup(){const a=t({fileName:"",autoWidth:!0,fileType:"xlsx"}),{exportDataToExcel:b}=f(),g=l(x),T=[{title:"编号",dataIndex:"key",align:"center"},{title:"姓名",dataIndex:"name",align:"center"},{title:"性别",dataIndex:"sex",align:"center"},{title:"手机",dataIndex:"phone",align:"center"},{title:"学历",dataIndex:"education",align:"center"},{title:"爱好",dataIndex:"hobby",align:"center"}],k=l([]),I=l([]);function S(e){k.value=e}function W(e,a,t){I.value=t}function C(e,a){I.value=a}function E(){if(!p(I).length)return void c.warning("请勾选要导出的数据项！");const e={data:p(I),header:["编号","姓名","性别","手机","学历","爱好"],key:["key","name","sex","phone","education","hobby"],fileName:a.fileName,autoWidth:a.autoWidth,bookType:a.fileType};b(e),k.value=[],I.value=[]}return()=>i(e,{plugin:m},{default:()=>[i(v,null,{default:()=>[i(n,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[i(o,{model:a,layout:"inline"},{default:()=>[i(s,{label:"文件名:",name:"fileName"},{default:()=>[i(u,{value:a.fileName,"onUpdate:value":e=>a.fileName=e,placeholder:"文件名"},null)]}),i(s,{label:"自动宽度:",name:"autoWidth"},{default:()=>[i(h,{value:a.autoWidth,"onUpdate:value":e=>a.autoWidth=e,options:[{label:"自动",value:!0},{label:"固定",value:!1}]},null)]}),i(s,{label:"文件类型:",name:"fileType"},{default:()=>[i(j,{value:a.fileType,"onUpdate:value":e=>a.fileType=e,options:[{label:"xlsx",value:"xlsx"},{label:"csv",value:"csv"},{label:"txt",value:"txt"}],style:{width:"180px"}},null)]}),i(s,null,{default:()=>[i(d,{type:"primary",htmlType:"submit",onClick:E},{default:()=>[r("导出Excel")]})]})]}),i(y,{dataSource:p(g),columns:T,rowSelection:{selectedRowKeys:p(k),onChange:S,onSelect:W,onSelectAll:C},pagination:!1},null)]})]})]})}});export{b as default};
