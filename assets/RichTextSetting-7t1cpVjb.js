var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,s=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&i(e,l,t[l]);if(n)for(var l of n(t))o.call(t,l)&&i(e,l,t[l]);return e},r=(e,n)=>t(e,l(n));import{V as c}from"./vue-drag-resize-2NMwPfIP.js";import{d as u,l as p,r as d,e as y,Y as f,a as g,c as h,d7 as x,cW as m,t as b,F as S,ap as v,B as w,d6 as k,a2 as O,a0 as j,q as z}from"./index-Ojv4YyAF.js";import{S as C}from"./index-hbqFzPdh.js";var D=(e=>(e.n="tm",e.e="mr",e.s="bm",e.w="ml",e.nw="tl",e.ne="tr",e.se="br",e.sw="bl",e))(D||{});const R=u({name:"DndNode",props:{element:{type:Object,default:()=>({})},handlers:{type:Array,default:()=>["n","e","s","w","nw","ne","se","sw"]}},emits:["change"],setup(e,{slots:t,emit:l}){const n=p(null),a=d(e.element),o=y((()=>e.handlers.map((e=>D[e]))));function i(e){var t,l;const o=null==(t=g(n))?void 0:t.$el;if(o&&"text"===a.type){const t=Math.ceil(null==(l=o.parentNode)?void 0:l.getBoundingClientRect().height),n=Math.ceil(o.querySelector(".rich-text-input").getBoundingClientRect().height);e+n>=t&&(a.y=t-n),o.style.height=`${n}px`,a.h=n}}function s({left:e,top:t}){a.x=e,a.y=t}function r({top:e}){"text"===a.type&&i(e)}function u({left:e,top:t,width:l,height:n}){a.x=e,a.y=t,a.w=l,a.h=n,"text"===a.type&&i(t)}function x(){a.active=!0}function m(){a.active=!1}return f(a,(()=>{l("change",a)})),f((()=>e.element),(e=>{"text"===e.type&&i(e.y)}),{deep:!0}),()=>h(c,{ref:n,isActive:a.active,x:a.x,y:a.y,z:a.z,w:a.w,h:a.h,minw:80,minh:24,sticks:g(o),parentLimitation:!0,onDragstop:s,onResizing:r,onResizestop:u,onActivated:x,onDeactivated:m},{default:()=>{var e;return[null==(e=t.default)?void 0:e.call(t)]}})}});const B=u({name:"RichTextInput",props:{value:{type:String,default:"请输入文本"},styles:{type:Object,default:()=>({})},hasBorder:{type:Boolean,default:!1}},emits:["update:value"],setup(e,{emit:t}){const l=y((()=>{const t=e.hasBorder?{border:"1px solid #d9d9d9",borderRadius:"6px"}:{};return s(s({minHeight:"20px",padding:"6px 8px",outline:"none",wordBreak:"break-all"},t),e.styles)})),n=x((e=>{t("update:value",e.target.innerHTML)}),200);function a(e){e.preventDefault();const l=function(e){const t=e.clipboardData||window.clipboardData;let l="";return t&&t.getData&&(l=t.getData("text/plain")),l}(e);t("update:value",l),m((()=>{!function(e){if(window.getSelection){e.focus();const t=window.getSelection();null==t||t.selectAllChildren(e),null==t||t.collapseToEnd()}else if(document.selection){const t=document.selection.createRange();t.moveToElementText(e),t.collapse(!1),t.select()}}(e.target)}))}return()=>h("div",{innerHTML:e.value,class:"rich-text-input",style:s({},g(l)),contentEditable:!0,spellCheck:"false",onPaste:a,onInput:n},null)}});function T(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!z(e)}const A=[{key:"left",label:"左对齐"},{key:"center",label:"居中"},{key:"right",label:"右对齐"}],I=u({name:"RichTextSetting",props:{textValue:{type:String,default:""},textStyles:{type:Object,default:()=>({})}},emits:["changeValue","changeStyles"],setup(e,{emit:t}){const l=p(e.textValue),{getThemeColor:n}=b();f((()=>e.textValue),(e=>l.value=e)),f((()=>l.value),(e=>t("changeValue",e)));const a=({key:l})=>{t("changeStyles",r(s({},e.textStyles),{textAlign:l}))},o=(l,n)=>{let a="";switch(l){case"fontWeight":a=n?"":"bold";break;case"fontStyle":a=n?"":"italic";break;case"textShadow":a=n?"":"1px 1px 1px #333"}t("changeStyles",r(s({},e.textStyles),{[l]:a||""}))};return()=>{let i,c;return h(S,{colon:!1,labelCol:{span:6},wrapperCol:{span:18},labelAlign:"left",style:{width:"300px",margin:"0 auto"}},{default:()=>[h(S.Item,{label:"文本"},{default:()=>[h(B,{value:l.value,"onUpdate:value":e=>l.value=e,hasBorder:!0},null)]}),h(S.Item,{label:"字体"},{default:()=>[h(C,{value:e.textStyles.fontFamily,onChange:l=>t("changeStyles",r(s({},e.textStyles),{fontFamily:l}))},T(i=["黑体","宋体","楷体","隶书","微软雅黑","华文行楷","方正姚体"].map((e=>h(C.Option,{value:e,key:e,style:{fontFamily:e}},T(e)?e:{default:()=>[e]}))))?i:{default:()=>[i]})]}),h(S.Item,{label:"字号"},{default:()=>[h(C,{value:e.textStyles.fontSize,onChange:l=>t("changeStyles",r(s({},e.textStyles),{fontSize:l,lineHeight:l}))},T(c=[12,14,16,20,24,32,48].map((e=>h(C.Option,{value:e+"px",key:e,style:{fontSize:e+"px"}},{default:()=>[e+"px"]}))))?c:{default:()=>[c]})]}),h(S.Item,{label:"样式"},{default:()=>[h(v,{size:6},{default:()=>[h(w,{icon:h(k,{name:"color-font",size:20},null),style:{color:e.textStyles.color}},null),h(w,{icon:h(k,{name:"color-bg",size:20},null),style:{color:e.textStyles.backgroundColor}},null),h(w,{icon:h(k,{name:"font-bold",size:20},null),style:{color:e.textStyles.fontWeight?g(n):""},onClick:()=>o("fontWeight",e.textStyles.fontWeight)},null),h(w,{icon:h(k,{name:"font-italic",size:20},null),style:{color:e.textStyles.fontStyle?g(n):""},onClick:()=>o("fontStyle",e.textStyles.fontStyle)},null),h(w,{icon:h(k,{name:"font-shadow",size:20},null),style:{color:e.textStyles.textShadow?g(n):""},onClick:()=>o("textShadow",e.textStyles.textShadow)},null),h(O,{placement:"bottomRight",trigger:["click"]},{default:()=>h(w,{icon:h(k,{name:"font-align",size:20},null)},null),overlay:()=>h(j,{items:A,selectedKeys:[e.textStyles.textAlign],onClick:a},null)})]})]})]})}}});export{R as D,B as R,I as a};
