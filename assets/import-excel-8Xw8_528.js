import{P as e}from"./PageWrapper-w2337QV-.js";import{d as t,l as r,t as s,c as o,ap as a,k as i,a as l,ar as n,s as p}from"./index-A-ZQTZn8.js";import{u as m}from"./useExcel-k6o-qDYo.js";import{C as d}from"./index-K-7oP10n.js";import{U as u}from"./index-yPQLw5DY.js";import{C as c}from"./CloudUploadOutlined-eTDifzN5.js";import{T as x}from"./index-wjp0mnHt.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-851RxE2J.js";import"./partition--2FYojOT.js";import"./DeleteOutlined-BIYMRGS8.js";import"./CheckOutlined-KsQDmQie.js";import"./index-DsNqFPI9.js";import"./List-8dJinh3D.js";import"./index-qeOjnFsQ.js";import"./index-ed9OLqQL.js";import"./index-M4qo23GO.js";import"./Checkbox-oYUxdkBt.js";import"./index-Byvpgacs.js";import"./Group-VbzXRN0Y.js";import"./index-l9QTTGEv.js";const j=t({name:"ImportExcel",setup(){const t=r([]),j=r([]),{readDataFromExcel:f}=m(),{getThemeColor:g}=s();function C(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void p.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:o}=f(r,"array");j.value=s.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=o},r.readAsArrayBuffer(e),r.onerror=()=>{p.error("Excel文件读取出错!")}}(s):p.warning("上传的Excel文件大小不能超过1M!")}return()=>o(e,{plugin:n},{default:()=>[o(d,null,{default:()=>[o(a,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[o(u,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:C},{default:()=>[o("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[o(c,null,null)]),o("p",null,[i("将Excel文件拖到此处, 或"),o("span",{style:{color:l(g)}},[i("点击上传")])])]}),o(x,{dataSource:l(t),columns:l(j),pagination:!1},null)]})]})]})}});export{j as default};
