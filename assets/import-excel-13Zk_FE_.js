import{P as e}from"./PageWrapper-kjRDiOIM.js";import{d as t,l as r,t as s,c as o,ap as a,k as i,a as l,ar as n,s as p}from"./index-uhPhvMRI.js";import{u as m}from"./useExcel-PiP1NfJQ.js";import{C as d}from"./index-M8qE7_hJ.js";import{U as u}from"./index-K0hAN0G7.js";import{C as c}from"./CloudUploadOutlined-2NVpnspV.js";import{T as x}from"./index-GGph-H7w.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-WtJRF0n5.js";import"./partition-CUGv5GgH.js";import"./DeleteOutlined-f9LY8FT8.js";import"./CheckOutlined-YW71hL-F.js";import"./index-gf3IiVSo.js";import"./List-LLGO4AKa.js";import"./index-8La93q0M.js";import"./index-yGiZe0r7.js";import"./index-OdAF1vjU.js";import"./Checkbox-og2vZ6-c.js";import"./index-Z3GkruCN.js";import"./Group-H5ZmEGII.js";import"./index-RKdaFY1h.js";const j=t({name:"ImportExcel",setup(){const t=r([]),j=r([]),{readDataFromExcel:f}=m(),{getThemeColor:g}=s();function C(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void p.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:o}=f(r,"array");j.value=s.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=o},r.readAsArrayBuffer(e),r.onerror=()=>{p.error("Excel文件读取出错!")}}(s):p.warning("上传的Excel文件大小不能超过1M!")}return()=>o(e,{plugin:n},{default:()=>[o(d,null,{default:()=>[o(a,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[o(u,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:C},{default:()=>[o("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[o(c,null,null)]),o("p",null,[i("将Excel文件拖到此处, 或"),o("span",{style:{color:l(g)}},[i("点击上传")])])]}),o(x,{dataSource:l(t),columns:l(j),pagination:!1},null)]})]})]})}});export{j as default};
