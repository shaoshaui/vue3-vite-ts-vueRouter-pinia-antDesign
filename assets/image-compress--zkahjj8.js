import{P as e}from"./PageWrapper-L1faufIO.js";import{U as t}from"./UploadImage-Y5BzhgZi.js";import{b as a,g as l,c as i}from"./image-UzVMQwv3.js";import{d as o,r as n,dn as d,H as m,c as s,F as u,ap as r,k as p,d6 as h,B as g,dp as c}from"./index-Ojv4YyAF.js";import{C as b}from"./index-qembNuiP.js";import{R as f,C as y}from"./index-LY0ajjoc.js";import{I as w}from"./index-4DENymYQ.js";import{S as v}from"./index-hbqFzPdh.js";import"./index-S_VSzahn.js";import"./partition-WHxA5Zz9.js";import"./DeleteOutlined-trckLPKD.js";import"./CheckOutlined-2t0Hcec6.js";import"./useMergedState-sYDefk8d.js";import"./isMobile-aGnBD7or.js";import"./List-I_OhhMX9.js";function x(e,t,l,i){!function(e,t,a,l){const i=void 0!==l?[l,e]:[e],o=new Blob(i,{type:a||"application/octet-stream"}),n=window.URL.createObjectURL(o),d=document.createElement("a");d.style.display="none",d.href=n,d.setAttribute("download",t),void 0===d.download&&d.setAttribute("target","_blank");document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(n)}(a(e),t,l,i)}const j=o({name:"ImageCompress",setup(){const a=n({width:1920,height:1080,aspectRatio:1920/1080,imgSrc:d}),o=n({width:1920,height:1080,ratio:100,quality:1,mimeType:"image/png"});m((()=>{l(d).then((({width:e,height:t})=>{o.width=e,o.height=t,a.width=e,a.height=t,a.aspectRatio=e/t}))}));const j=e=>{a.imgSrc=e,l(e).then((({width:e,height:t})=>{o.width=e,o.height=t,a.width=e,a.height=t,a.aspectRatio=e/t}))},I=(e,t)=>{const l=Number("width"===t?Math.round(e*a.aspectRatio).toFixed(0):Math.round(e/a.aspectRatio).toFixed(0)),i=Number(Math.round(l/a[t]*100).toFixed(2));o[t]=l,o.ratio=i},S=()=>{const{width:e,height:t,quality:l,mimeType:n}=o,d=n.replace(/image\//,"")||"png";i(a.imgSrc,{width:e,height:t,quality:l,mimeType:n}).then((e=>{x(e,`compress-image.${d}`)}))};return()=>s(e,{plugin:c},{default:()=>[s(f,{gutter:12},{default:()=>[s(y,{span:16},{default:()=>[s(b,{title:"图片区域",bodyStyle:{height:"500px"}},{default:()=>[s("div",{className:"flex-center"},[s("div",{style:{width:"800px",height:"450px",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundImage:`url(${a.imgSrc})`}},null)])]})]}),s(y,{span:8},{default:()=>[s(b,{title:"设置区域",bodyStyle:{height:"500px"}},{default:()=>[s(u,{colon:!1,labelCol:{span:6},wrapperCol:{span:18},labelAlign:"left",style:{width:"300px",margin:"50px auto"}},{default:()=>[s(u.Item,{label:"上传图片"},{default:()=>[s(t,{name:"选择图片",isFull:!0,onSuccess:j},null)]}),s(u.Item,{label:"图片尺寸",style:{marginBottom:0}},{default:()=>[s(r,null,{default:()=>[s(u.Item,{name:"width",noStyle:!0},{default:()=>[s(w,{value:o.width,"onUpdate:value":e=>o.width=e,min:0,max:a.width,controls:!1,addonBefore:s("span",null,[p("宽")]),onChange:e=>I(e,"height")},null)]}),s(u.Item,{noStyle:!0},{default:()=>[s(h,{name:"linking"},null)]}),s(u.Item,{name:"height",noStyle:!0},{default:()=>[s(w,{value:o.height,"onUpdate:value":e=>o.height=e,min:0,max:a.height,controls:!1,addonBefore:s("span",null,[p("高")]),onChange:e=>I(e,"width")},null)]})]})]}),s(u.Item,{label:"压缩比例",name:"ratio"},{default:()=>[s(w,{value:o.ratio,"onUpdate:value":e=>o.ratio=e,min:0,max:100,disabled:!0,controls:!1,formatter:e=>`${e}%`,style:{width:"100%"}},null)]}),s(u.Item,{label:"图片质量",name:"quality"},{default:()=>[s(v,{value:o.quality,"onUpdate:value":e=>o.quality=e,options:[{value:1,label:100},{value:.8,label:80},{value:.6,label:60},{value:.4,label:40}]},null)]}),s(u.Item,{label:"图片格式",name:"mimeType"},{default:()=>[s(v,{value:o.mimeType,"onUpdate:value":e=>o.mimeType=e,options:[{value:"image/png",label:"PNG"},{value:"image/jpg",label:"JPG"},{value:"image/bmp",label:"BMP"}]},null)]}),s(u.Item,{label:" "},{default:()=>[s(g,{type:"primary",style:{width:"100%"},onClick:S},{default:()=>[p("压缩图片")]})]})]})]})]})]})]})}});export{j as default};
