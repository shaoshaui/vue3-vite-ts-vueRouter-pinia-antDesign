import{P as e}from"./PageWrapper-L1faufIO.js";import{d as t,l as r,t as s,c as o,ap as a,k as i,a as l,ar as n,s as p}from"./index-Ojv4YyAF.js";import{u as m}from"./useExcel-qnj2AzXI.js";import{C as d}from"./index-qembNuiP.js";import{U as u}from"./index-S_VSzahn.js";import{C as c}from"./CloudUploadOutlined-a9-_Ur_N.js";import{T as x}from"./index--U3abuxV.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-sYDefk8d.js";import"./partition-WHxA5Zz9.js";import"./DeleteOutlined-trckLPKD.js";import"./CheckOutlined-2t0Hcec6.js";import"./index-hbqFzPdh.js";import"./List-I_OhhMX9.js";import"./index-ONY_esXn.js";import"./index-rvKTZ55N.js";import"./index-oUpBFUUQ.js";import"./Checkbox-8Gq0tBlb.js";import"./index-XjXfxWll.js";import"./Group-ps9Br0BT.js";import"./index-5_HjOA4A.js";const j=t({name:"ImportExcel",setup(){const t=r([]),j=r([]),{readDataFromExcel:f}=m(),{getThemeColor:g}=s();function C(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void p.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:o}=f(r,"array");j.value=s.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=o},r.readAsArrayBuffer(e),r.onerror=()=>{p.error("Excel文件读取出错!")}}(s):p.warning("上传的Excel文件大小不能超过1M!")}return()=>o(e,{plugin:n},{default:()=>[o(d,null,{default:()=>[o(a,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[o(u,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:C},{default:()=>[o("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[o(c,null,null)]),o("p",null,[i("将Excel文件拖到此处, 或"),o("span",{style:{color:l(g)}},[i("点击上传")])])]}),o(x,{dataSource:l(t),columns:l(j),pagination:!1},null)]})]})]})}});export{j as default};
