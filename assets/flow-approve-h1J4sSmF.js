var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,p=(e,t)=>{for(var o in t||(t={}))d.call(t,o)&&l(e,o,t[o]);if(r)for(var o of r(t))a.call(t,o)&&l(e,o,t[o]);return e},s=(e,r)=>t(e,o(r));import{P as i}from"./PageWrapper-w2337QV-.js";import{d as n,c as y,l as c,H as b,s as x,as as u}from"./index-A-ZQTZn8.js";import{s as f,l as h,L as v}from"./index-KEsFMlqX.js";import{C as g}from"./index-K-7oP10n.js";import"./partition--2FYojOT.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-851RxE2J.js";const m=[{type:"apply",label:"申请",style:{width:"30px",height:"30px",borderRadius:"15px",border:"2px solid #FF6347"},property:{username:"",time:"",startTime:"",endTime:""}},{type:"approver",label:"审批",style:{width:"50px",height:"40px",borderRadius:"4px",border:"2px solid #3CB371"}},{type:"jugement",label:"判断",style:{width:"30px",height:"30px",border:"2px solid #6495ED",transform:"rotate(45deg)"}},{type:"finsh",label:"结束",style:{width:"30px",height:"30px",borderRadius:"15px",border:"2px solid #FF6347"}}],w={nodes:[{id:"28df2fbe-f32b-4a9b-b544-7e70d7187b33",type:"apply",x:210,y:210,text:{x:210,y:210,value:"申请"},properties:{}},{id:"64179bd7-c60e-433c-8df7-97c8e98f855d",type:"approver",x:350,y:210,text:{x:350,y:210,value:"审批"},properties:{labelColor:"#000000",approveTypeLabel:"直接上级",approveType:"leader"}},{id:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",type:"jugement",x:510,y:210,text:{x:510,y:210,value:"判断报销是否\n大于1000元"},properties:{api:""}},{id:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",type:"approver",x:670,y:210,text:{x:670,y:210,value:"审批"},properties:{labelColor:"#000000",approveTypeLabel:"T2领导",approveType:"t2Leader"}},{id:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",type:"finsh",x:850,y:210,text:{x:850,y:210,value:"结束"},properties:{}}],edges:[{id:"0d87b1eb-2389-445a-9f34-6227940b2072",type:"polyline",sourceNodeId:"28df2fbe-f32b-4a9b-b544-7e70d7187b33",targetNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",startPoint:{x:235,y:210},endPoint:{x:300,y:210},text:{x:51.25,y:0,value:""},properties:{},pointsList:[{x:235,y:210},{x:300,y:210}]},{id:"d99e7451-b379-411e-b0da-df11be8be20a",type:"polyline",sourceNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",targetNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",startPoint:{x:400,y:210},endPoint:{x:475,y:210},text:{x:437.5,y:210,value:"通过"},properties:{},pointsList:[{x:400,y:210},{x:475,y:210}]},{id:"4c615802-15d8-442c-be22-b65430286123",type:"polyline",sourceNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",targetNodeId:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",startPoint:{x:545,y:210},endPoint:{x:620,y:210},text:{x:582.5,y:210,value:"是"},properties:{},pointsList:[{x:545,y:210},{x:620,y:210}]},{id:"934ae03a-6ee0-4568-a2b4-8bcede565e0b",type:"polyline",sourceNodeId:"9f119df3-c449-4e5d-a67a-cb351b9cbdb5",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:720,y:210},endPoint:{x:825,y:210},text:{x:-10,y:0,value:""},properties:{},pointsList:[{x:720,y:210},{x:825,y:210}]},{id:"bd5e1dd0-1978-46f7-851b-d31c03aebee9",type:"polyline",sourceNodeId:"64179bd7-c60e-433c-8df7-97c8e98f855d",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:350,y:170},endPoint:{x:850,y:185},text:{x:600,y:140,value:"驳回"},properties:{},pointsList:[{x:350,y:170},{x:350,y:140},{x:850,y:140},{x:850,y:185}]},{id:"453139c3-faa1-4e3a-a413-38f251243baa",type:"polyline",sourceNodeId:"fcb96f10-720e-40e5-8ed0-ebdd0a46f234",targetNodeId:"ef34f09c-38ea-4ad4-acd2-cc2f464a2be6",startPoint:{x:510,y:245},endPoint:{x:850,y:235},text:{x:680,y:275,value:"否"},properties:{},pointsList:[{x:510,y:245},{x:510,y:275},{x:850,y:275},{x:850,y:235}]}]},N=n({name:"NodePanel",props:{lf:{type:Object,default:()=>({})}},setup:e=>()=>y("div",{class:f["node-panel"]},[m.map((t=>y("div",{class:f["node-item"],key:t.type},[y("div",{style:p({},t.style),onMousedown:()=>{e.lf.value.dnd.startDrag({type:t.type,text:t.label})}},null),y("div",{class:f.name},[t.label])])))])});function P(e){var t,o,r,d,a;class i extends h.CircleNodeModel{getConnectedTargetRules(){const e=super.getConnectedTargetRules();return e.push({message:"开始节点只能连出，不能连入！",validate:(e,t)=>{let o=!0;return t&&(o=!1),o}}),e}}null==(t=e.value)||t.register({type:"apply",view:h.CircleNode,model:i});class n extends h.RectNode{getLabelShape(){const{x:e,y:t,width:o,height:r,properties:d}=this.props.model,{labelColor:a,approveTypeLabel:l}=d;return h.h("text",{fill:a,fontSize:12,x:e-o/2+5,y:t-r/2+15,width:50,height:25},l)}getShape(){const{x:e,y:t,width:o,height:r,radius:d}=this.props.model,a=this.props.model.getNodeStyle();return h.h("g",{},[h.h("rect",s(p({},a),{x:e-o/2,y:t-r/2,rx:d,ry:d,width:o,height:r})),this.getLabelShape()])}}l(n,"symbol"!=typeof(a="extendKey")?a+"":a,"UserTaskNode");class y extends h.RectNodeModel{constructor(e,t){super(e,t),this.properties={labelColor:"#000000",approveTypeLabel:"",approveType:""}}}null==(o=e.value)||o.register({type:"approver",view:n,model:y});class c extends h.PolygonNodeModel{constructor(e,t){super(e,t),this.points=[[35,0],[70,35],[35,70],[0,35]],this.properties={api:""}}}null==(r=e.value)||r.register({type:"jugement",view:h.PolygonNode,model:c});class b extends h.CircleNodeModel{getConnectedSourceRules(){const e=super.getConnectedSourceRules();return e.push({message:"结束节点只能连入，不能连出！",validate:e=>{let t=!0;return e&&(t=!1),t}}),e}}null==(d=e.value)||d.register({type:"finsh",view:h.CircleNode,model:b})}const C={stopScrollGraph:!0,stopZoomGraph:!0,grid:{size:10,visible:!0,type:"mesh",config:{color:"#DCDCDC"}},keyboard:{enabled:!0},style:{rect:{radius:8,stroke:"#3CB371"},circle:{r:25,stroke:"#FF6347"},polygon:{stroke:"#6495ED"},polyline:{strokeWidth:1},edgeText:{background:{fill:"white"}}}},j=n({name:"Approve",setup(){const e=c(null);b((()=>{e.value=new v(s(p({},C),{container:document.querySelector("#graphApprove")})),P(e),e.value.render(w),t(e)}));const t=e=>{var t,o;null==(t=e.value)||t.on("element:click",(()=>{})),null==(o=e.value)||o.on("connection:not-allowed",(e=>{x.error(e.msg)}))};return()=>y("div",{style:{position:"relative",width:"100%",height:"100%"}},[e.value&&y(N,{lf:e},null),y("div",{id:"graphApprove",style:{height:"100%"}},null)])}}),L=n({name:"FlowApprove",setup:()=>()=>y(i,{plugin:u},{default:()=>[y(g,null,{default:()=>[y("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"500px"}},[y(j,null,null)])]})]})});export{L as default};
