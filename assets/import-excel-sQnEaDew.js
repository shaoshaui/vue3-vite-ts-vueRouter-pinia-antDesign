import{P as e}from"./PageWrapper-_w1STvok.js";import{d as t,l as r,t as s,c as o,ap as a,k as i,a as l,ar as n,s as p}from"./index-hPCwy2cU.js";import{u as m}from"./useExcel-S-Osj0es.js";import{C as d}from"./index--VM6Akgl.js";import{U as u}from"./index-Z5-e6Vuq.js";import{C as c}from"./CloudUploadOutlined-wR5VZq0n.js";import{T as x}from"./index-ei48mbtJ.js";import"./isMobile-aGnBD7or.js";import"./useMergedState-VhlIxWjY.js";import"./partition-MJYMOLMf.js";import"./DeleteOutlined-fsmw97KG.js";import"./CheckOutlined-WBtOhnNS.js";import"./index-Fa6AgMat.js";import"./List-teIXDyNS.js";import"./index-HouOtm8A.js";import"./index-GQSaD8dc.js";import"./index-O8biUKFP.js";import"./Checkbox-eQOZ5DzF.js";import"./index-jaExAoBv.js";import"./Group-moBsfik-.js";import"./index-ewp8BvIh.js";const j=t({name:"ImportExcel",setup(){const t=r([]),j=r([]),{readDataFromExcel:f}=m(),{getThemeColor:g}=s();function C(e){const{file:r}=e,s=r.originFileObj;if(!s)return;if(!/\.(xlsx|xls|csv)$/.test(s.name))return void p.warning("Excel文件只支持.xlsx, .xls, .csv格式!");s.size/1024/1024<1?function(e){const r=new FileReader;r.onload=e=>{const r=e.target&&e.target.result,{header:s,results:o}=f(r,"array");j.value=s.map((e=>({title:e,dataIndex:e,align:"center"}))),t.value=o},r.readAsArrayBuffer(e),r.onerror=()=>{p.error("Excel文件读取出错!")}}(s):p.warning("上传的Excel文件大小不能超过1M!")}return()=>o(e,{plugin:n},{default:()=>[o(d,null,{default:()=>[o(a,{direction:"vertical",size:16,style:{width:"100%"}},{default:()=>[o(u,{ref:"uploadExcel",accept:".xlsx, .xls, .csv",showUploadList:!1,maxCount:1,onChange:C},{default:()=>[o("p",{class:"ant-upload-drag-icon",style:"margin-bottom: 0;"},[o(c,null,null)]),o("p",null,[i("将Excel文件拖到此处, 或"),o("span",{style:{color:l(g)}},[i("点击上传")])])]}),o(x,{dataSource:l(t),columns:l(j),pagination:!1},null)]})]})]})}});export{j as default};
